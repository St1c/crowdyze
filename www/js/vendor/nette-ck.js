/**
 * NetteForms - simple form validation.
 *
 * This file is part of the Nette Framework.
 * Copyright (c) 2004, 2013 David Grudl (http://davidgrudl.com)
 */var Nette=Nette||{};Nette.addEvent=function(e,t,n){var r=e["on"+t];e["on"+t]=function(){return typeof r=="function"&&r.apply(e,arguments)===!1?!1:n.apply(e,arguments)}};Nette.getValue=function(e){var t,n;if(!e)return null;if(!e.nodeName){for(t=0,n=e.length;t<n;t++)if(e[t].checked)return e[t].value;return null}if(e.nodeName.toLowerCase()==="select"){var r=e.selectedIndex,i=e.options,s=[];if(r<0)return null;if(e.type==="select-one")return i[r].value;for(t=0,n=i.length;t<n;t++)i[t].selected&&s.push(i[t].value);return s}return e.type==="checkbox"?e.checked:e.type==="radio"?Nette.getValue(e.form.elements[e.name].nodeName?[e]:e.form.elements[e.name]):e.value.replace("\r","").replace(/^\s+|\s+$/g,"")};Nette.validateControl=function(e,t,n){t=t||Nette.parseJSON(e.getAttribute("data-nette-rules"));for(var r=0,i=t.length;r<i;r++){var s=t[r],o=s.op.match(/(~)?([^?]+)/);s.neg=o[1];s.op=o[2];s.condition=!!s.rules;var u=s.control?e.form.elements[s.control]:e,a=Nette.validateRule(u,s.op,s.arg);if(a===null)continue;s.neg&&(a=!a);if(s.condition&&a){if(!Nette.validateControl(e,s.rules,n))return!1}else if(!s.condition&&!a){if(u.disabled)continue;n||Nette.addError(u,s.msg.replace("%value",Nette.getValue(u)));return!1}}return!0};Nette.validateForm=function(e){var t=e.form||e,n=!1;if(t["nette-submittedBy"]&&t["nette-submittedBy"].getAttribute("formnovalidate")){var r=Nette.parseJSON(t["nette-submittedBy"].getAttribute("data-nette-validation-scope"));if(!r.length)return!0;n=new RegExp("^("+r.join("-|")+"-)")}for(var i=0;i<t.elements.length;i++){var s=t.elements[i];if(!(s.nodeName.toLowerCase()in{input:1,select:1,textarea:1})||s.type in{hidden:1,submit:1,image:1,reset:1}||n&&!s.name.replace(/]\[|\[|]|$/g,"-").match(n)||s.disabled||s.readonly)continue;if(!Nette.validateControl(s))return!1}return!0};Nette.addError=function(e,t){e.focus&&e.focus();t&&alert(t)};Nette.validateRule=function(e,t,n){var r=Nette.getValue(e);e.getAttribute&&r===e.getAttribute("data-nette-empty-value")&&(r="");t.charAt(0)===":"&&(t=t.substr(1));t=t.replace("::","_");t=t.replace(/\\/g,"");return Nette.validators[t]?Nette.validators[t](e,n,r):null};Nette.validators={filled:function(e,t,n){return n!==""&&n!==!1&&n!==null},valid:function(e,t,n){return Nette.validateControl(e,null,!0)},equal:function(e,t,n){if(t===undefined)return null;t=Nette.isArray(t)?t:[t];for(var r=0,i=t.length;r<i;r++)if(n==(t[r].control?Nette.getValue(e.form.elements[t[r].control]):t[r]))return!0;return!1},minLength:function(e,t,n){return n.length>=t},maxLength:function(e,t,n){return n.length<=t},length:function(e,t,n){t=Nette.isArray(t)?t:[t,t];return(t[0]===null||n.length>=t[0])&&(t[1]===null||n.length<=t[1])},email:function(e,t,n){return/^("([ !\x23-\x5B\x5D-\x7E]*|\\[ -~])+"|[-a-z0-9!#$%&'*+\/=?^_`{|}~]+(\.[-a-z0-9!#$%&'*+\/=?^_`{|}~]+)*)@([0-9a-z\u00C0-\u02FF\u0370-\u1EFF]([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,61}[0-9a-z\u00C0-\u02FF\u0370-\u1EFF])?\.)+[a-z\u00C0-\u02FF\u0370-\u1EFF][-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,17}[a-z\u00C0-\u02FF\u0370-\u1EFF]$/i.test(n)},url:function(e,t,n){return/^(https?:\/\/|(?=.*\.))([0-9a-z\u00C0-\u02FF\u0370-\u1EFF](([-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,61}[0-9a-z\u00C0-\u02FF\u0370-\u1EFF])?\.)*[a-z\u00C0-\u02FF\u0370-\u1EFF][-0-9a-z\u00C0-\u02FF\u0370-\u1EFF]{0,17}[a-z\u00C0-\u02FF\u0370-\u1EFF]|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\[[0-9a-f:]{3,39}\])(:\d{1,5})?(\/\S*)?$/i.test(n)},regexp:function(e,t,n){var r=typeof t=="string"?t.match(/^\/(.*)\/([imu]*)$/):!1;if(r)try{return(new RegExp(r[1],r[2].replace("u",""))).test(n)}catch(i){}},pattern:function(e,t,n){try{return typeof t=="string"?(new RegExp("^("+t+")$")).test(n):null}catch(r){}},integer:function(e,t,n){return/^-?[0-9]+$/.test(n)},"float":function(e,t,n){return/^-?[0-9]*[.,]?[0-9]+$/.test(n)},range:function(e,t,n){return Nette.isArray(t)?(t[0]===null||parseFloat(n)>=t[0])&&(t[1]===null||parseFloat(n)<=t[1]):null},submitted:function(e,t,n){return e.form["nette-submittedBy"]===e}};Nette.toggleForm=function(e,t){var n;Nette.toggles={};for(n=0;n<e.elements.length;n++)e.elements[n].nodeName.toLowerCase()in{input:1,select:1,textarea:1,button:1}&&Nette.toggleControl(e.elements[n],null,null,t);for(n in Nette.toggles)Nette.toggle(n,Nette.toggles[n])};Nette.toggleControl=function(e,t,n,r){t=t||Nette.parseJSON(e.getAttribute("data-nette-rules"));var i=!1,s=Object.prototype.hasOwnProperty,o=function(){Nette.toggleForm(e.form)};for(var u=0,a=t.length;u<a;u++){var f=t[u],l=f.op.match(/(~)?([^?]+)/);f.neg=l[1];f.op=l[2];f.condition=!!f.rules;if(!f.condition)continue;var c=f.control?e.form.elements[f.control]:e,h=n;if(h!==!1){h=Nette.validateRule(c,f.op,f.arg);if(h===null)continue;f.neg&&(h=!h)}if(Nette.toggleControl(e,f.rules,h,r)||f.toggle){i=!0;if(r)if(!c.nodeName)for(var p=0;p<c.length;p++)Nette.addEvent(c[p],"click",o);else c.nodeName.toLowerCase()==="select"?Nette.addEvent(c,"change",o):Nette.addEvent(c,"click",o);for(var d in f.toggle||[])s.call(f.toggle,d)&&(Nette.toggles[d]=Nette.toggles[d]||h&&f.toggle[d])}}return i};Nette.parseJSON=function(s){s=s||"[]";return s.substr(0,3)==="{op"?eval("["+s+"]"):window.JSON&&window.JSON.parse?JSON.parse(s):eval(s)};Nette.toggle=function(e,t){var n=document.getElementById(e);n&&(n.style.display=t?"":"none")};Nette.initForm=function(e){e.noValidate="novalidate";Nette.addEvent(e,"submit",function(){return Nette.validateForm(e)});Nette.addEvent(e,"click",function(t){t=t||event;var n=t.target||t.srcElement;e["nette-submittedBy"]=n.type in{submit:1,image:1}?n:null});Nette.toggleForm(e,!0);if(/MSIE/.exec(navigator.userAgent)){var t={},n=function(){return!1},r=function(){document.getElementById(this.htmlFor).focus();return!1};for(i=0,elms=e.getElementsByTagName("label");i<elms.length;i++)t[elms[i].htmlFor]=elms[i];for(i=0,elms=e.getElementsByTagName("select");i<elms.length;i++){Nette.addEvent(elms[i],"mousewheel",n);t[elms[i].htmlId]&&Nette.addEvent(t[elms[i].htmlId],"click",r)}}};Nette.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"};Nette.addEvent(window,"load",function(){for(var e=0;e<document.forms.length;e++)Nette.initForm(document.forms[e])});(function(e,t,n){if(typeof t!="function")return console.error("nette.ajax.js: jQuery is missing, load it please");var r=function(){var e={self:this,initialized:!1,contexts:{},on:{init:{},load:{},prepare:{},before:{},start:{},success:{},complete:{},error:{}},fire:function(){var r=!0,i=Array.prototype.slice.call(arguments),s=i.shift(),o=typeof s=="string"?s:s.name,u=typeof s=="object"?s.off||{}:{};i.push(e.self);t.each(e.on[o],function(s,o){if(o===n||t.inArray(s,u)!==-1)return!0;var a=o.apply(e.contexts[s],i);return r=a===n||a});return r},requestHandler:function(t){if(!e.self.ajax({},this,t))return},ext:function(r,i,s){while(!s){s="ext_"+Math.random();e.contexts[s]&&(s=n)}t.each(r,function(t,n){e.on[t][s]=n});e.contexts[s]=t.extend(i?i:{},{name:function(){return s},ext:function(t,n){var r=e.contexts[t];if(!r&&n)throw"Extension '"+this.name()+"' depends on disabled extension '"+t+"'.";return r}})}};this.ext=function(r,i,s){if(typeof r=="object")e.ext(r,i);else{if(i===n)return e.contexts[r];if(!i){t.each(["init","load","prepare","before","start","success","complete","error"],function(t,i){e.on[i][r]=n});e.contexts[r]=n}else{if(typeof r=="string"&&e.contexts[r]!==n)throw"Cannot override already registered nette-ajax extension '"+r+"'.";e.ext(i,s,r)}}return this};this.init=function(t,r){if(e.initialized)throw"Cannot initialize nette-ajax twice.";if(typeof t=="function"){this.ext("init",null);this.ext("init",{load:t},r)}else if(typeof t=="object"){this.ext("init",null);this.ext("init",t,r)}else if(t!==n)throw"Argument of init() can be function or function-hash only.";e.initialized=!0;e.fire("init");this.load();return this};this.load=function(){e.fire("load",e.requestHandler);return this};this.ajax=function(r,i,s){if(!r.nette&&i&&s){var o=t(i),u,a,f=r.nette={e:s,ui:i,el:o,isForm:o.is("form"),isSubmit:o.is("input[type=submit]")||o.is("button[type=submit]"),isImage:o.is("input[type=image]"),form:null};f.isSubmit||f.isImage?f.form=f.el.closest("form"):f.isForm&&(f.form=f.el);r.url||(r.url=f.form?f.form.attr("action"):i.href);r.type||(r.type=f.form?f.form.attr("method"):"get");if(o.is("[data-ajax-off]")){var l=o.attr("data-ajax-off");l.indexOf("[")===0?r.off=o.data("ajaxOff"):l.indexOf(",")!==-1?r.off=l.split(","):l.indexOf(" ")!==-1?r.off=l.split(" "):r.off=l;typeof r.off=="string"&&(r.off=[r.off]);r.off=t.grep(t.each(r.off,function(e){return t.trim(e)}),function(e){return e.length})}}e.fire({name:"prepare",off:r.off||{}},r);r.prepare&&r.prepare(r);a=r.beforeSend;r.beforeSend=function(t,r){var i=e.fire({name:"before",off:r.off||{}},t,r);(i||i===n)&&a&&(i=a(t,r));return i};return this.handleXHR(t.ajax(r),r)};this.handleXHR=function(t,n){n=n||{};if(t&&(typeof t.statusText=="undefined"||t.statusText!=="canceled")){t.done(function(t,r,i){e.fire({name:"success",off:n.off||{}},t,r,i)}).fail(function(t,r,i){e.fire({name:"error",off:n.off||{}},t,r,i)}).always(function(t,r){e.fire({name:"complete",off:n.off||{}},t,r)});e.fire({name:"start",off:n.off||{}},t,n);n.start&&n.start(t,n)}return t}};t.nette=new(t.extend(r,t.nette?t.nette:{}));t.fn.netteAjax=function(e,n){return t.nette.ajax(n||{},this[0],e)};t.fn.netteAjaxOff=function(){return this.off(".nette")};t.nette.ext("validation",{before:function(e,r){if(!r.nette)return!0;var i=r.nette,s=i.e,o=t.extend({keys:!0,url:!0,form:!0},r.validate||function(){if(!i.el.is("[data-ajax-validate]"))return;var e=i.el.data("ajaxValidate");if(e===!1)return{keys:!1,url:!1,form:!1};if(typeof e=="object")return e}()||{}),u=!1;if(i.el.attr("data-ajax-pass")!==n){u=i.el.data("ajaxPass");u=typeof u=="bool"?u:!0}if(o.keys){var a=s.button||s.ctrlKey||s.shiftKey||s.altKey||s.metaKey;if(i.form){if(a&&i.isSubmit){this.explicitNoAjax=!0;return!1}if(i.isForm&&this.explicitNoAjax){this.explicitNoAjax=!1;return!1}}else if(a)return!1}if(o.form&&i.form&&(!i.isSubmit&&!i.isImage||i.el.attr("formnovalidate")===n)&&i.form.get(0).onsubmit&&i.form.get(0).onsubmit(s)===!1){s.stopImmediatePropagation();s.preventDefault();return!1}if(o.url&&/:|^#/.test(i.form?r.url:i.el.attr("href")))return!1;if(!u){s.stopPropagation();s.preventDefault()}return!0}},{explicitNoAjax:!1});t.nette.ext("forms",{init:function(){var t;if(!e.Nette||!(t=this.ext("snippets")))return;t.after(function(t){t.find("form").each(function(){e.Nette.initForm(this)})})},prepare:function(e){var n=e.nette;if(!n||!n.form)return;var r=n.e,i=e.data||{},s={};if(n.isSubmit)s[n.el.attr("name")]=n.el.val()||"";else if(n.isImage){var o=n.el.offset(),u=n.el.attr("name"),a=[Math.max(0,r.pageX-o.left),Math.max(0,r.pageY-o.top)];if(u.indexOf("[",0)!==-1)s[u]=a;else{s[u+".x"]=a[0];s[u+".y"]=a[1]}}typeof i!="string"&&(i=t.param(i));s=t.param(s);e.data=n.form.serialize()+(s?"&"+s:"")+"&"+i}});t.nette.ext("snippets",{success:function(e){var n=[],r=[];if(e.snippets){for(var i in e.snippets){var s=this.getElement(i);s.get(0)&&r.push(s.get(0));t.each(this.beforeQueue,function(e,t){typeof t=="function"&&t(s)});this.updateSnippet(s,e.snippets[i]);t.each(this.afterQueue,function(e,t){typeof t=="function"&&t(s)})}var o=t(r).promise();t.each(this.completeQueue,function(e,t){typeof t=="function"&&o.done(t)})}}},{beforeQueue:[],afterQueue:[],completeQueue:[],before:function(e){this.beforeQueue.push(e)},after:function(e){this.afterQueue.push(e)},complete:function(e){this.completeQueue.push(e)},updateSnippet:function(e,t,n){typeof e=="string"&&(e=this.getElement(e));e.is("title")?document.title=t:this.applySnippet(e,t,n)},getElement:function(e){return t("#"+this.escapeSelector(e))},applySnippet:function(e,t,n){!n&&e.is("[data-ajax-append]")?e.append(t):e.html(t)},escapeSelector:function(e){return e.replace(/[\!"#\$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|\}~]/g,"\\$&")}});t.nette.ext("redirect",{success:function(t){if(t.redirect){e.location.href=t.redirect;return!1}}});t.nette.ext("state",{success:function(e){e.state&&(this.state=e.state)}},{state:null});t.nette.ext("unique",{start:function(e){this.xhr&&this.xhr.abort();this.xhr=e},complete:function(){this.xhr=null}},{xhr:null});t.nette.ext("abort",{init:function(){t("body").keydown(t.proxy(function(e){this.xhr&&e.keyCode.toString()==="27"&&!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)&&this.xhr.abort()},this))},start:function(e){this.xhr=e},complete:function(){this.xhr=null}},{xhr:null});t.nette.ext("load",{success:function(){t.nette.load()}});t.nette.ext("init",{load:function(e){t(this.linkSelector).off("click.nette",e).on("click.nette",e);t(this.formSelector).off("submit.nette",e).on("submit.nette",e).off("click.nette",":image",e).on("click.nette",":image",e).off("click.nette",":submit",e).on("click.nette",":submit",e);t(this.buttonSelector).closest("form").off("click.nette",this.buttonSelector,e).on("click.nette",this.buttonSelector,e)}},{linkSelector:"a.ajax",formSelector:"form.ajax",buttonSelector:'input.ajax[type="submit"], button.ajax[type="submit"], input.ajax[type="image"]'})})(window,window.jQuery);